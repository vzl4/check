import{R as M,b as L,aG as N,aH as R,U as B,bk as $,W as D,b$ as v,j as e,K as c,aC as T,aF as P,ax as O,M as C,bZ as q,a as w,b_ as J,ay as f,bl as Q,aA as U,r as y,aQ as X,dJ as G,dK as Z,dL as _,T as V,bP as Y,l as ee,bj as se,bR as te,bB as ne,e as E,dM as S,dN as oe}from"./main-Cz_EDjso.js";import{M as re}from"./ModalExternal-Bc4p8-uQ.js";import{P as ce}from"./analytics-C4g1w3Ww.js";import{u as W,P as H,s as p,f as b,a as I}from"./PremiumModal-BNGw1tw5.js";import{R as z,a as ae}from"./RewardPaymentEl-DJaO0Moh.js";import{f as ie,P as le}from"./PremiumTime-DnpUiTt6.js";import"./workers-0KObbvUQ.js";import"./ScrollArea-D_4_3NIY.js";const me=u=>{const{data:a}=N(R.PaymentsModal),l=a.place,{product:s,width:o,Icon:t}=u,i=B(n=>n.payment.purscaseProduct),x=$(D.Success),d=s.bonus?Math.round(parseInt(s.name)/(1+s.bonus)):parseInt(s.name),g=s.bonus?parseInt(s.name)-d:0,h=s.discount?Math.round(s.price/(1-s.discount)):s.price,m=()=>{i({product:s,source:l}),q.trackClickShopItem(s.tag,l)},{gap:j,imageSize:r}=W();return v()?e.jsx(H,{width:o,onClick:m,children:e.jsxs(c,{gap:j,h:"100%",align:"center",justify:"space-between",direction:"column",children:[e.jsxs(c,{direction:"column",align:"center",children:[e.jsxs(c,{gap:6,align:"center",children:[e.jsx(T,{fw:"bold",fz:24,children:d}),e.jsx(t,{h:22,w:26})]}),s.bonus?e.jsxs(c,{gap:6,align:"center",mt:-8,children:[e.jsxs(T,{fw:"bold",fz:24,color:x,children:["+",g]}),e.jsx(t,{h:22,w:26})]}):null]}),e.jsx(P,{src:s.icon,maw:`min(100%, ${r}px)`,mah:r,style:{filter:"drop-shadow(2px 2px 4px rgb(27, 32, 29))"}}),e.jsx(O,{onClick:m,className:p.payButton,children:e.jsxs(c,{direction:"column",children:[s.discount?e.jsxs("span",{className:p.crossPrice,children:[b(h)," ",I(C.isPlaygama()?s.currency:s.currencySymbol)]}):null,e.jsxs("span",{children:[b(s.price)," ",I(C.isPlaygama()?s.currency:s.currencySymbol)]})]})})]})}):null},A=M.memo(me,L),ue=u=>{const{width:a}=u,l=B(m=>m.modals.openPremiumModal),{icon:s,price:o,discount:t,currency:i}=w(m=>{var n;const j=J(((n=m.payment.products)==null?void 0:n.products)||[]),r=j[0]||{};return{price:r.price||0,discount:r.discount||0,currency:C.isPlaygama()?r.currency:r.currencySymbol,icon:(j[j.length-1]||{}).icon||""}},L),{gap:x,imageSize:d}=W(),g=$(D.Success);if(C.getPlatformType()===ce.FOTOSTRANA||!v())return null;const h=t?Math.round(o/(1-t)):o;return e.jsx(e.Fragment,{children:e.jsx(H,{width:a,onClick:l,children:e.jsxs(c,{gap:x,align:"center",h:"100%",justify:"space-between",direction:"column",children:[e.jsx(c,{gap:4,align:"center",children:e.jsx(T,{fw:"bold",fz:18,children:f("premium")})}),e.jsx(P,{src:s,maw:`min(100%, ${d}px)`,mah:d}),C.isPremium()?e.jsx(c,{py:"xs",children:e.jsx(Q,{color:g,size:U.xxs})}):e.jsx(O,{onClick:l,className:p.payButton,children:e.jsxs(c,{direction:"column",children:[t?e.jsx("span",{className:p.crossPrice,children:f("priceFrom",{price:b(h),currency:I(i)})}):null,e.jsx("span",{children:f("priceFrom",{price:b(o),currency:I(i)})})]})})]})})})},F=M.memo(ue),k=()=>{const u=G().filter(a=>a.isActive)[0];return Math.round((new Date(u.dateEnd).getTime()-new Date().getTime())/1e3)},K=()=>{const[u,a]=y.useState(0),[l,s]=y.useState(null),o=()=>{const t=G().filter(i=>i.isActive&&i.timeLeft>0)[0];return s(t?t.tag:null),t};return y.useEffect(()=>{const t=o();if(t){const i=setTimeout(()=>a(x=>x+1),(t==null?void 0:t.timeLeft)>10?1e4:((t==null?void 0:t.timeLeft)??10)*1e3);return clearTimeout(i)}},[]),y.useEffect(()=>{o()},[u]),l},de=()=>{const u=K(),[a,l]=y.useState(k());y.useEffect(()=>{const t=setInterval(()=>{l(k())},1e3);return()=>clearInterval(t)},[]);const s=X(),o=ie(a,s);return e.jsx(e.Fragment,{children:!!u&&e.jsx(c,{align:"center",style:{fontSize:18},children:o})})},pe=()=>{const{closeModal:u}=N(R.PaymentsModal),a=K(),l=w(n=>n.flags.promoIcon),s=w(n=>n.flags.promoImage),o=w(n=>n.payment.products),t=Z((o==null?void 0:o.products)||[]),i=_((o==null?void 0:o.products)||[]),x=w(n=>n.config.windowSize.windowWidth<=400),d=V(),g=C.isCrazyGames(),h=v();let m=0;Y().isAdvDisabled||(m+=2),h&&(m+=1,t.length&&(m+=t.length),i.length&&!g&&(m+=i.length));const r=`calc(${d?50:100/Math.ceil(m/2)}% - var(--mantine-spacing-xs))`;return e.jsx(re,{fullScreen:h?d:d&&x,visible:!0,id:ee.modal.payments.index,withCloseButton:!0,onClose:u,titleCentered:!0,size:h?"xl":void 0,title:e.jsxs(c,{align:"center",direction:"column",gap:4,children:[a?e.jsxs(c,{gap:8,align:"center",direction:"column",children:[e.jsxs(c,{gap:4,children:[e.jsx("span",{children:l}),f("stock"),e.jsx("span",{children:l})]}),e.jsx(de,{})]}):f("shop"),e.jsxs(c,{gap:10,align:"center",direction:a?"column":"row",children:[e.jsx(oe,{}),e.jsx(le,{})]})]}),absoluteContent:e.jsx(e.Fragment,{children:!!a&&e.jsxs(e.Fragment,{children:[e.jsx(P,{className:E(p.promoImageTopLeft,{[p.promoImageTopLeftCenter]:S()}),src:s}),e.jsx(P,{className:E(p.promoImageTopRight,{[p.promoImageTopRightCenter]:S()}),src:s}),S()?null:e.jsxs(e.Fragment,{children:[e.jsx(P,{className:p.promoImageBottomLeft,src:s}),e.jsx(P,{className:p.promoImageBottomRight,src:s})]})]})}),children:e.jsx(se,{justify:"center",gap:"xs",onlyHorOffset:!0,children:e.jsxs(c,{direction:"row",gap:"sm",justify:"center",w:"100%",wrap:"wrap",p:5,pb:a?14:5,children:[g&&e.jsx(z,{width:r},"rewarded-cash"),d&&e.jsx(F,{width:r},"premium-modal-button"),e.jsx(ae,{width:r},"rewarded-crystal"),t.length?t.map(n=>e.jsx(A,{width:r,product:n,Icon:te},n.id)):h?f("loading"):null,!d&&e.jsx(F,{width:r},"premium-modal-button"),!g&&e.jsxs(e.Fragment,{children:[e.jsx(z,{width:r},"rewarded-cash"),i.length?i.map(n=>e.jsx(A,{width:r,product:n,Icon:ne},n.id)):h?f("loading"):null]})]})})})},we=M.memo(pe);export{we as default};
