import{r as g,c5 as S,j as e,K as m,c6 as M,at as F,ap as b,c7 as L,as as N,R as z,aG as P,aH as T,A as W,c8 as E,c9 as k,ca as $,cb as G,bo as q,bp as O,ay as H,l as K,bj as V,cc as Z,aC as D,cd as f,bt as U,aM as X,V as Y,W as J,X as Q,az as ee,aA as te,Y as re,Z as se,bZ as ae}from"./main-Cz_EDjso.js";import{M as oe}from"./ModalExternal-Bc4p8-uQ.js";import"./analytics-C4g1w3Ww.js";import"./workers-0KObbvUQ.js";import"./ScrollArea-D_4_3NIY.js";const ne="_CustomBoard_1yt9f_1",B={CustomBoard:ne,"CustomBoard-container":"_CustomBoard-container_1yt9f_15"},ie=s=>s.map((t,n)=>[...t.map((a,i)=>{const l=N(i,n);return{square:l,color:s.length%2===0?b(l):L(b(l)),figure:a||void 0}})]),le=s=>{const{board:t,arrows:n,size:a="100%"}=s,i=c=>`${c[0]}${Number(c[1])+(8-t.length)}`,l=g.useMemo(()=>n.map(c=>({from:i(c.from),chain:c.chain.map(i),color:c.color,width:S*(8/t.length)})),[n]),o=ie(t);return e.jsxs(m,{className:B["CustomBoard-container"],style:{width:a,paddingBottom:a},children:[e.jsx(M,{size:t.length,onTop:!0,arrows:l,isShowCanvas:!0}),e.jsx("div",{className:B.CustomBoard,style:{gridTemplateRows:`repeat(${t.length}, 1fr)`,gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:e.jsx(F,{board:o,isCustomBoard:!0})})]})},ce="_ruleImage_11mzr_1",ue="_ruleImageWrapper_11mzr_9",me="_ruleImageLoader_11mzr_13",C={ruleImage:ce,ruleImageWrapper:ue,ruleImageLoader:me},I=({disable:s=!1,onClick:t,direction:n,isComputer:a=!1,...i})=>{const l=U(X.Outline);return e.jsx(Y,{disabled:s,groupButton:!0,...l,size:40,variant:"outline",onClick:t,mb:5,...a&&{color:J.Primary,variant:"filled"},...s&&{opacity:.5},children:e.jsx(Q,{disabled:s,...i,children:(()=>{if(a)return e.jsx(ee,{size:te.md});if(n===f.Left)return e.jsx(re,{});if(n===f.Right)return e.jsx(se,{})})()})})},de=s=>{const{rules:t,imageContainerPt:n,onlyText:a}=s,{closeModal:i}=P(T.RulesModal),l=W(),[o,c]=g.useState(0),_=E(k.MainMenuPlayButtonClick),R=$(),p=g.useRef(null);g.useEffect(()=>{setTimeout(()=>{var r;return(r=p.current)==null?void 0:r.focus()},150)},[p.current]);const{isPort:h,isLand:y,isSmall:u}=G();if(!q().feature[O.Rules])return null;const j=r=>{ae.trackSwapRulesPage(r),c(()=>r>t.length-1?0:r<0?t.length-1:r)},A=async()=>{i(),await _(),await R()},w=()=>j(o-1),v=()=>{if(o===t.length-1){A();return}j(o+1)},d=t[o];return e.jsx(oe,{fullScreen:!1,visible:!0,id:K.modal.rules.index,withCloseButton:!0,onClose:i,titleCentered:!0,size:"50vh",...u&&{size:"90vh"},...u&&!y&&{size:"90vw"},title:H("rules"),children:e.jsx("div",{ref:p,tabIndex:0,onKeyUp:r=>{r.key==="ArrowLeft"&&w(),r.key==="ArrowRight"&&v()},children:e.jsx(V,{justify:"center",gap:"xs",onlyHorOffset:!0,children:e.jsxs(m,{direction:"column",gap:"xs",align:"center",justify:"center",w:"100%",children:[e.jsxs(m,{direction:"column",align:"center",justify:"flex-start",gap:"xs",w:"100%",children:[t.map((r,x)=>"image"in r&&!a?e.jsx(m,{ref:x===o?l.ref:void 0,align:"center",justify:"center",className:C.ruleImageWrapper,w:"100%",pb:"100%",...u&&{w:"50%",pb:"50%"},...u&&h&&{w:"100%",pb:"100%"},pt:n,style:x!==o?{pointerEvents:"none",position:"absolute",opacity:0}:{},children:z.isValidElement(r.image)?r.image:e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:C.ruleImageLoader}),e.jsx("img",{src:r.image,className:C.ruleImage})]})},x):null),"board"in d&&e.jsx(le,{size:u&&!h?"50%":"100%",board:d.board,arrows:d.arrows}),e.jsx(D,{component:"div",fz:"1em",lh:void 0,mih:"11vh",...u&&{fz:"0.9em",lh:1.1,mih:"12vh"},...u&&y&&{fz:"0.9em",lh:1.1,mih:"10vh"},...u&&h&&{fz:"0.9em",lh:1.1,mih:"26vw"},children:d.title})]}),e.jsxs(m,{gap:"lg",children:[e.jsx(I,{direction:f.Left,onClick:w,disable:o===0}),e.jsx(I,{direction:f.Right,onClick:v,isComputer:o===t.length-1})]})]})})})})},ye=z.memo(de);export{ye as default};
