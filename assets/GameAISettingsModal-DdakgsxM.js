import{j as e,ax as T,ay as E,az as H,aA as y,K as v,aB as k,aC as A,aD as M,a as G,r as l,U as z,aE as P,l as c,aF as L,R as B,aG as F,aH as R,aI as W,$ as b,b as D,a1 as w,J as $,aJ as U,aK as J,aL as K,W as q,aM as Q,aN as Y}from"./main-Cz_EDjso.js";import{M as V}from"./ModalExternal-Bc4p8-uQ.js";import{Q as C,Y as N}from"./analytics-C4g1w3Ww.js";import{H as X,a as Z}from"./HintsSwitch-Ci2QMKJK.js";import{s as p,G as ee}from"./GameSettings-BjRaJEZ_.js";import{S as I}from"./Skeleton-CrccMNn7.js";import"./workers-0KObbvUQ.js";import"./ScrollArea-D_4_3NIY.js";import"./Switch-kkRJNaF4.js";import"./Background-CzE9_nId.js";import"./RewardPaymentEl-DJaO0Moh.js";import"./PremiumModal-BNGw1tw5.js";import"./PremiumTime-DnpUiTt6.js";const te=({onClick:a,id:o,title:i="toBegin",withIcon:m=!1,mt:s,w:d})=>e.jsx(T,{mt:s,onClick:a,id:o,w:d,leftSection:m?e.jsx(H,{size:y.md,style:{minWidth:20}}):null,children:E(i)}),ae=({opponentInfo:a})=>e.jsx(v,{align:"flex-start",justify:"space-between",children:e.jsxs(v,{gap:"0.5rem",align:"center",children:[e.jsx(k,{src:a.avatar,radius:"sm",size:64,styles:C||N?{image:{objectPosition:C?"top":"center"}}:void 0}),e.jsxs(A,{component:"div",children:[a.name," - ",a.rating," ",e.jsx(M,{size:12})]})]})}),se=a=>{const[o,i]=l.useState(a.src),[m,s]=l.useState(!0);return l.useEffect(()=>{a.src&&(i(a.src),s(!0))},[a.src]),e.jsx(I,{visible:m,children:e.jsx("div",{style:{width:"100%",paddingBottom:C||N?"175%":"100%",position:"relative"},children:e.jsx(L,{...a,style:{position:"absolute",left:0,right:0},...m?{w:"100%",pb:"100%"}:{w:"100%",h:"100%"},src:o,onError:()=>s(!0),onLoad:()=>s(!1)})})})},_=a=>Object.values(a).map(o=>({rating:o.rating,name:o.name,avatar:o.avatar})),ne=({toggleOpponentSelection:a,colsCnt:o})=>{const i=G(t=>t.config.currentOpponents),m=G(t=>t.config.opponentProvider),[s,d]=l.useState(_(i));l.useEffect(()=>{d(_(i));let t=!1;return(async()=>Object.values(i).forEach((r,n)=>{if(!r.avatar&&r.avaGender){if(t)return;m.fetchAvaToObjectUrl(r).then(S=>{const O={rating:r.rating,name:r.name,avatar:S};t||d(g=>(t||(g=[...g],g.splice(n,1,O)),g))})}}))(),()=>{t=!0}},[i]);const f=G(t=>t.session.isNicksGenerationProcess),h=z(t=>t.engine.setOptionLevelType),j=t=>{a(),h(t)},x=Object.values(c.modal.aiGame.opponentCard);return e.jsx(P,{className:p.Opponents,classNames:{inner:p.opponentsInner},style:{"--cols-cnt":o},children:s.map((t,u)=>e.jsxs(v,{direction:"column",align:"center",gap:4,onClick:()=>j(u+1),className:p.Opponents__card,id:x[u],children:[e.jsx(se,{radius:"sm",src:t.avatar,maw:"100%",className:p.Opponents__card__avatar}),e.jsx(I,{visible:f,children:e.jsx(A,{component:"div",className:p.Opponents__card__text_name,ta:"center",maw:"100%",lineClamp:1,children:t.name})}),e.jsxs(A,{component:"div",className:p.Opponents__card__text_rating,truncate:!0,maw:"100%",lh:.9,pb:4,children:[t.rating," ",e.jsx(M,{size:12})]})]},x[u]))})},oe=()=>{const{closeModal:a}=F(R.GameAISettingsModal),[o,i]=W(!1),m=b(n=>n.gameSettings.handicapEnabled),s=b(n=>n.config.currentOpponents[n.engine.optionLevelType]??{},D),d=b(n=>n.config.opponentProvider),f=w(n=>n.config.initOpponentAvatarAndName),h=w(n=>n.app.startGame),j=w(n=>n.app.openMenu),[x,t]=l.useState({rating:s.rating,name:s.name,avatar:s.avatar});l.useEffect(()=>{if(t({rating:s.rating,name:s.name,avatar:s.avatar}),!s.avatar&&s.avaGender){let n=!1;return(async()=>{if(n)return;const S=await d.fetchAvaToObjectUrl(s);n||t(O=>({...O,avatar:S}))})(),()=>{n=!0}}},[s]),l.useEffect(()=>{f()},[]);const u=l.useCallback(()=>{a(),i.close(),h()},[a,h]),r=62;return e.jsx(V,{visible:!0,id:c.modal.aiGame.index,onClose:()=>{a(),j(),i.close()},title:E("choiceOpponent"),size:o?void 0:"90vh",isModalPaddingTopExist:o,contentStyles:{maxHeight:"calc( var(--vh, 1vh) * 100 )"},titleRightComponent:o&&e.jsx(K,{className:p["Title__change-opponent-button"],id:c.modal.aiGame.button.changeOpponent,onClick:i.toggle,size:y.lg,variant:Q.Transparent,color:q.Neutral,style:{marginLeft:"-0.5rem"},children:e.jsx(Y,{size:y.xxxs})}),bottomComponent:o&&e.jsx(te,{id:c.modal.aiGame.button.startAiGame,onClick:u,mt:"sm"}),children:e.jsxs($,{w:"100%",children:[!o&&e.jsx(ne,{toggleOpponentSelection:i.toggle,colsCnt:5}),o&&e.jsx(ee,{timeHidden:!0,id:c.modal.aiGame.gameSettings,options:e.jsxs(e.Fragment,{children:[e.jsx(ae,{opponentInfo:x}),e.jsxs(v,{style:{paddingTop:"0.25rem"},direction:"column",children:[e.jsx(X,{id:c.modal.aiGame.switch.showHint,w:r}),e.jsx(Z,{id:c.modal.aiGame.switch.showHandicap,w:r}),e.jsx(U,{id:c.modal.aiGame.switch.jumpersSwitch,checkboxFrameW:r})]}),m&&e.jsx(J,{id:c.modal.aiGame.handicapSettings})]})})]})})},je=B.memo(oe);export{je as default};
