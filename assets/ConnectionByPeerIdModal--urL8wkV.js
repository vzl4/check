import{R as W,a as g,dA as k,r as i,dC as $,aQ as H,bk as L,W as _,j as e,bd as U,e as V,K as n,ct as J,cc as M,aC as T,aD as K,bB as Q,bo as q,d3 as X,dD as Y,dE as Z,bE as ee,br as te,dF as se,dG as ae,aG as ne,aH as oe,U as D,cs as R,dH as re,dI as ie,bu as le,dy as ce,d2 as O,ay as C,l as B,J as de,ax as A,bP as me,du as pe,bH as G}from"./main-Cz_EDjso.js";import{M as ue}from"./ModalExternal-Bc4p8-uQ.js";import{f as ge}from"./formatPlayerName-CbEGQV3k.js";import{F as he}from"./GameSettings-BjRaJEZ_.js";import{d as xe}from"./debounce-Duy6lWxL.js";import{D as fe}from"./Divider-LWlDoTpr.js";import"./analytics-C4g1w3Ww.js";import"./workers-0KObbvUQ.js";import"./ScrollArea-D_4_3NIY.js";import"./Background-CzE9_nId.js";import"./RewardPaymentEl-DJaO0Moh.js";import"./PremiumModal-BNGw1tw5.js";import"./PremiumTime-DnpUiTt6.js";const be="_lobbyCard_dnk69_1",je="_lobbyCardLoading_dnk69_12",ye="_lobbyCardDisabled_dnk69_15",F={lobbyCard:be,lobbyCardLoading:je,lobbyCardDisabled:ye},Ce=({position:s,children:l})=>s?e.jsx("div",{style:{...s,position:"absolute"},children:l}):l,I=24,Se=({lobby:s,start:l,connectionStarted:a,setConnectionStarted:h,first:x})=>{const{stepTime:p,gameTime:o,timeControl:u,hintsEnabled:f,handicapEnabled:m,color:c,betSize:b=0}=s.customData,v=g(w=>w.config.gameT),P=k(),S=g(w=>w.config.windowSize.windowWidth<=400),z=g(w=>w.platform.playerCash),[d,E]=i.useState(!1),j=s.customData.boardType===$?"Amateur":s.customData.boardType||null,t=()=>{E(!0),h(!0),l(s.code)};i.useEffect(()=>{P||E(!1)},[P]),H();const r=z<b,N=L(_.LightNeutral),y=L(_.Neutral);return e.jsx(U,{shadow:"sm",p:"xs",withBorder:!x,className:V(F.lobbyCard,{[F.lobbyCardLoading]:d&&a,[F.lobbyCardDisabled]:!d&&a||r}),onClick:d||a||r?void 0:t,children:e.jsxs(n,{justify:"space-between",gap:"xs",maw:"100%",align:"center",children:[e.jsxs(n,{gap:"xs",align:"center",miw:0,style:{position:"relative"},children:[e.jsx("div",{style:{opacity:d?.5:1},children:e.jsx(J,{isPremium:!!s.customData.player.premium,avatar:s.customData.player.avatar,title:s.customData.player.name,size:32})}),e.jsx(Ce,{position:{left:-4,top:-4,zIndex:2},children:d&&e.jsx(M,{size:40,m:0,color:N,type:"ring"})}),e.jsx(T,{fw:500,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0},children:ge(s.customData.player.name)}),e.jsxs(n,{gap:4,align:"center",children:[s.customData.rating,e.jsx(K,{size:18})]}),!!b&&e.jsxs(n,{gap:4,align:"center",children:[b,e.jsx(Q,{size:18})]})]}),e.jsxs(n,{gap:S?"xs":"md",align:"center",children:[e.jsx(n,{gap:4,align:"center",justify:"flex-end",miw:S?50:u?72:20,children:u?e.jsxs(e.Fragment,{children:[!S&&e.jsx(n,{gap:"xs",align:"center",style:{color:y},children:e.jsx(X,{width:18,height:18,isAnimate:!1})}),e.jsx(T,{size:"sm",c:y,children:`${o} ${p}`===Y?"5 + 3":`${o/60} + ${p}`})]}):e.jsx(Z,{size:I,color:y,style:{opacity:.7}})}),q().whiteAndBlackSides&&e.jsx(he,{color:c===ee?null:c,size:I}),f&&e.jsx(te,{size:I,color:y}),m&&e.jsx(se,{size:I,color:y}),!!j&&j!=="none"&&e.jsxs(n,{gap:"xs",align:"center",children:[e.jsx(ae,{size:I,color:y}),e.jsx(T,{size:"sm",children:v("boardType",{})[j]||j})]})]})]})})},we=W.memo(Se),Ie=({connectionStarted:s,setConnectionStarted:l})=>{const[a,h]=i.useState(""),[x,p]=i.useState(!0),o=R(),u=D(m=>m.app.startOnlineWithFriendGameByPeerId),f=i.useCallback(m=>{const c=m.currentTarget.value;h(c),p(!!c)},[h]);return me().connectionTypeForTogetherOnline!==pe.ById?null:e.jsxs(e.Fragment,{children:[e.jsx(G.Wrapper,{label:C("enterGameIdToConnect"),error:!x,children:e.jsx(G,{disabled:o,placeholder:"ID",value:a,onChange:f,size:"sm"})}),e.jsx(A,{id:B.modal.p2pReconnect.button.reconnectGame,onClick:s?void 0:()=>{u(a),l(!0)},loading:o,disabled:o||!x||!a,children:C("toBegin")})]})},Te=()=>{const{closeModal:s}=ne(oe.ConnectionByPeerIdModal),l=g(t=>t.online.onlineState),a=k(),h=D(t=>()=>{s(),t.app.createOnlineWithFriendGame()}),x=R(),[p,o]=i.useState(x),u=g(t=>{var r;return(r=t.platform.player)==null?void 0:r.id}),f=g(t=>{var r;return(r=t.platform.player)==null?void 0:r.rating})||re(),m=g(t=>t.config.windowSize.windowWidth<=400),c=ie(),b=D(t=>t.app.startOnlineWithFriendGameByPeerId),v=i.useCallback(xe(b,300),[b]),P=L(le.Reject2),S=D(t=>t.online.setOfflineState),z=()=>{l===O.WAIT_FRIEND&&S({ignorePassive:!0,ignoreGameState:!0,reason:"close_play-online_together_client_modal"}),s()};i.useEffect(()=>{a||o(!1)},[a]),i.useEffect(()=>{ce.updateLobbiesFilter(f)},[f]);const d=i.useMemo(()=>c===null?null:c.filter(t=>t.customData.player.id!==u),[c,u]),j=(!!a||l===O.OFFLINE)&&a?C("peerError")[a]:"";return e.jsx(ue,{fullScreen:m,visible:!0,id:B.modal.rewardedVideoError.index,onClose:z,title:C("playOnlineWithFriend"),bodyPadding:m?"0":void 0,titleCentered:!0,children:e.jsx(de,{justify:"center",children:e.jsxs(n,{direction:"column",gap:"md",align:"center",w:"100%",children:[e.jsx(Ie,{connectionStarted:p,setConnectionStarted:o}),e.jsx(T,{ta:"center",c:P,children:j}),e.jsx(n,{justify:"center",align:"center",w:"100%",px:"xs",children:e.jsx(A,{id:B.modal.onlineTogetherModeSelect.createGameButton,onClick:h,children:C("createGame")})}),e.jsx(fe,{w:"100%"}),d===null?e.jsx(n,{justify:"center",mih:35,w:"100%",children:e.jsx(M,{size:"sm"})}):e.jsx(e.Fragment,{children:d.length?e.jsx(n,{direction:"column",w:"100%",mt:"-md",children:d.map((t,r)=>e.jsx(we,{first:r===0,lobby:t,start:v,connectionStarted:p,setConnectionStarted:o},t.code))}):e.jsx(T,{ta:"center",children:C("noPublicGames")})})]})})})},Me=W.memo(Te);export{Me as default};
