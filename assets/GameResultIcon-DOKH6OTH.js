import{cJ as P,ay as a,ch as v,F as _,cg as x,j as e,cK as N,cw as A,cp as W,cL as z,cM as V,a as m,aQ as O,cN as k,cO as K,K as B,aC as u,bY as E,bB as $,G as F,aD as H,cP as Q,c0 as J,bk as b,W as R,M as Y,R as Z,cm as q,r as w,aF as X,cQ as ee}from"./main-Cz_EDjso.js";import{C}from"./CustomPopover-BiKCfJi1.js";import{b as se}from"./leaderboard.services.ui-Cy1UHfbc.js";import"./analytics-C4g1w3Ww.js";var T=(s=>(s.ConnectionLost="delete",s.TimesUp="timer",s.BlackCheckMate="black-checkmate",s.WhiteCheckMate="white-checkmate",s.GiveUp="white-flag",s.Exit="exit",s))(T||{});function te(s){return P({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7.775 0a1.8 1.8 0 0 0-1.273.527L.528 6.503A1.8 1.8 0 0 0 0 7.775v8.45c0 .478.19.936.528 1.274l5.974 5.974A1.8 1.8 0 0 0 7.775 24h8.45a1.8 1.8 0 0 0 1.273-.527l5.975-5.974A1.8 1.8 0 0 0 24 16.225v-8.45a1.8 1.8 0 0 0-.527-1.272L17.498.527A1.8 1.8 0 0 0 16.225 0zm4.427 3c1.02 0 .958 1.108.958 1.108v6.784s-.009.218.16.218c.188 0 .175-.226.175-.226l-.002-5.63s-.05-.986.959-.986c1.01 0 .97.983.97.983v7.621s.014.158.141.158c.127 0 .944-2.122.944-2.122s.451-1.497 2.576-1.1c.038.008-.167.688-.167.688l-2.283 6.556S15.69 20.7 11.714 20.7c-5.044 0-4.808-5.407-4.814-5.405V7.562s-.016-.99.897-.99c.858 0 .849.99.849.99l.007 3.583s-.004.172.167.172c.16 0 .141-.172.141-.172l.01-5.926s-.055-1.162.966-1.162c1.04 0 .983 1.142.983 1.142v5.611s-.005.204.152.204c.168 0 .154-.206.154-.206l.01-6.693S11.18 3 12.202 3Z"},child:[]}]})(s)}const fe=({gameResult:s,isNotCancelledMatch:n})=>{if(!n)return a("gameHasBeenCancelled");if([v.Victory,v.WhitesVictory,v.BlacksVictory,v.Defeat].includes(s))return a(s)},ne=({gameState:s,gameType:n,gameCompletionReason:t,timeIsUp:i,width:o,height:r})=>{const p=r/12;if(s===_.Menu)return{tooltipText:a("leaveFromLastGame"),icName:T.Exit};if(i)return{icName:T.TimesUp,tooltipText:a("timesUp")};if([x.BrokenConnection].includes(t))return{icElem:e.jsx(N,{style:{width:o,height:r}}),tooltipText:a("connectionLose")};if(A(n)&&t===x.DrawByAgreement)return{tooltipText:a("byAgreement"),icElem:e.jsx(W,{style:{width:o,height:r,marginTop:p}})};if([x.PlayerGiveUp,x.ComputerGiveUp,x.AFK1,x.AFK].includes(t)){const f=t===x.PlayerGiveUp;return{icName:T.GiveUp,tooltipText:a(f?"youGiveUp":"opponentGiveUp")}}else{if(t===z.DrawRepeatingPosition)return{icElem:e.jsx(V,{style:{width:o,height:r,marginTop:p}}),tooltipText:a("repeatingPosition")};if(t===z.AllCheckersBlocked)return{icElem:e.jsx(te,{style:{width:o,height:r,marginTop:p}}),tooltipText:a("noPossibleMoves")}}},L=({diff:s,isWin:n})=>{const t=b(R.Success),i=b(R.Reject),o=s>0?"+":s<0?"-":n?"+":"-",r=(()=>{if(s>0)return t;if(s<0)return i})();return e.jsxs(u,{component:"span",mx:5,c:r,fw:700,children:[e.jsx("span",{style:{marginRight:5},children:o}),Math.abs(s)]})},ie=({time:s,isBest:n})=>{const t=b(R.Success),i=O(),o=n?t:void 0;return e.jsx(u,{component:"span",mx:5,c:o,fw:700,children:se(s,i)})},oe=({diff:s,isDraw:n})=>{const t=b(R.Success);if(!s)return;let i=s,o=0;return Y.isPremium()&&(i=Math.round(i/1.2),o=Math.round(i*.2)),e.jsxs(e.Fragment,{children:[e.jsxs(u,{component:"div",mx:5,c:t,fw:700,children:[e.jsx("span",{style:{marginRight:5},children:"+"}),n?`2 * ${i/2}`:i]}),o?e.jsxs(u,{component:"div",mr:5,c:t,fw:700,children:[e.jsx("span",{style:{marginRight:5},children:"+"}),o]}):""]})},xe=()=>{const s=m(l=>l.app.gameType),n=m(l=>l.online.ratingGameResult),t=m(l=>l.platform.playerCash);O();const i=m(l=>l.gameSettings.isGameWithSimplifications),{rating:o=0,ratingDiff:r=0,commonScore:p=0,scoreDiff:f=0,bestTime:g=0,oldBestTime:S=0,betSize:h=0,gameResult:j=k.Victory}=n||{},G=j===k.Draw,d=j===k.Victory,U=p-f,M=o-r;let y=d?Math.floor(h*2*K()):G?0:-h;const c=t-y;return e.jsxs(B,{direction:"column",align:"center",justify:"center",children:[A(s)&&!!h&&!!y&&e.jsx(C,{label:a("gold"),offset:0,children:e.jsxs(u,{component:"div",fw:"500",size:"md",lineClamp:1,display:"flex",miw:100,style:{alignItems:"center"},children:[e.jsx("div",{style:{marginRight:5},children:e.jsx($,{size:14})}),E(c)," ",e.jsx(L,{diff:y,isWin:d}),e.jsx(u,{fz:12,children:d?`(${a("tax")} 15%)`:""})]})}),!i&&s!==F.Single&&e.jsx(C,{label:a("rating"),offset:0,children:e.jsxs(u,{component:"div",fw:"500",size:"md",lineClamp:1,display:"flex",miw:100,style:{alignItems:"center"},children:[e.jsx(H,{size:16,mr:5}),E(M)," ",e.jsx(L,{diff:r,isWin:d})]})}),s===F.Single&&j===v.Victory&&e.jsx(C,{label:a("timeRecord"),offset:0,children:e.jsxs(u,{component:"div",fw:"500",size:"md",lineClamp:1,display:"flex",miw:100,style:{alignItems:"center"},children:[e.jsx(Q,{size:16,mr:5}),e.jsx(ie,{time:g,isBest:S<g})]})}),e.jsx(B,{align:"center",children:e.jsx(C,{label:a("score"),offset:0,children:e.jsxs(u,{component:"div",fw:"500",size:"md",lineClamp:1,display:"flex",miw:100,style:{alignItems:"center",justifyContent:"center"},children:[e.jsx(J,{size:16,mr:5}),E(U)," ",e.jsx(oe,{diff:f,isDraw:G})]})})})]})},ce="_icon__shadow_1jge4_1",ae={icon__shadow:ce},re=async s=>{try{const n=await ee({url:`https://s3.eponesh.com/games/files/11406/${s}.png`,responseType:"blob",method:"GET"}),t=URL.createObjectURL(n.data);let i=document.createElement("img");return i.src=t,t}catch{return null}},le=s=>{let{height:n,width:t,getGameResultIconData:i}=s;const o=m(c=>c.session.timesUp),r=m(c=>c.app.gameType),p=m(c=>c.session.gameCompleteReason),f=q(),g=m(c=>c.app.gameState),S=m(c=>c.app.gameResult),h=m(c=>c.board.myColor),[j,G]=w.useState(null),[d,U]=w.useState(void 0),[M,y]=w.useState("");return w.useEffect(()=>{const c={gameState:g,gameType:r,gameCompletionReason:p,gameResult:S,myColor:h,timeIsUp:o,isNotCancelledMatch:f,width:t,height:n},{tooltipText:l,icName:D,icElem:I}=ne(c)??i(c)??{};l&&I?(U(I),y(l)):l&&D&&(async()=>(G(await re(D)),y(l)))()},[i,g,r,p,S,h,o,t,n]),!(f||g===_.Menu)||!(d||j)?null:e.jsx("div",{children:e.jsx(C,{label:M,children:d||e.jsx(X,{src:j,w:t,h:n,className:ae.icon__shadow})})})},ge=Z.memo(le);export{ge as G,xe as R,fe as g};
