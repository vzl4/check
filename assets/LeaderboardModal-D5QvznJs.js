import{aT as Se,x as z,y as O,j as e,z as W,aY as te,a_ as se,a$ as $,bL as F,b6 as Q,R as v,aQ as re,bi as H,a as S,U as B,r as M,K as L,cc as Te,ay as A,cU as k,e as E,bY as ne,M as U,cC as h,cV as G,cW as _e,cX as je,cY as Ce,aB as ve,b as le,aD as Ne,cZ as Z,cP as Me,bB as Le,c0 as Be,bk as we,W as Pe,bF as Re,l as w,T as ke,c_ as He,c$ as De,bo as Fe,bp as Ge,d0 as C,aG as Ie,aH as $e,bt as J,aM as ee,c8 as qe,c9 as ze,V as Oe,X as We,bq as Ae,d1 as Ee}from"./main-Cz_EDjso.js";import{M as Ue}from"./ModalExternal-Bc4p8-uQ.js";import"./analytics-C4g1w3Ww.js";import{S as Ve}from"./ScrollArea-D_4_3NIY.js";import{b as Ye}from"./leaderboard.services.ui-Cy1UHfbc.js";import"./workers-0KObbvUQ.js";const[Xe,Ke]=Se("Table component was not found in the tree");var P={table:"m_b23fa0ef",th:"m_4e7aa4f3",tr:"m_4e7aa4fd",td:"m_4e7aa4ef",tbody:"m_b2404537",thead:"m_b242d975",caption:"m_9e5a3ac7",scrollContainer:"m_a100c15",scrollContainerInner:"m_62259741"};function Qe(a,t){if(!t)return;const o={};return t.columnBorder&&a.withColumnBorders&&(o["data-with-column-border"]=!0),t.rowBorder&&a.withRowBorders&&(o["data-with-row-border"]=!0),t.striped&&a.striped&&(o["data-striped"]=a.striped),t.highlightOnHover&&a.highlightOnHover&&(o["data-hover"]=!0),t.captionSide&&a.captionSide&&(o["data-side"]=a.captionSide),t.stickyHeader&&a.stickyHeader&&(o["data-sticky"]=!0),o}function j(a,t){const o=`Table${a.charAt(0).toUpperCase()}${a.slice(1)}`,r=z((l,d)=>{const n=O(o,{},l),{classNames:i,className:b,style:f,styles:p,...y}=n,c=Ke();return e.jsx(W,{component:a,ref:d,...Qe(c,t),...c.getStyles(a,{className:b,classNames:i,style:f,styles:p,props:n}),...y})});return r.displayName=`@mantine/core/${o}`,r.classes=P,r}const q=j("th",{columnBorder:!0}),de=j("td",{columnBorder:!0}),R=j("tr",{rowBorder:!0,striped:!0,highlightOnHover:!0}),ie=j("thead",{stickyHeader:!0}),ce=j("tbody"),me=j("tfoot"),be=j("caption",{captionSide:!0});function V({data:a}){return e.jsxs(e.Fragment,{children:[a.caption&&e.jsx(be,{children:a.caption}),a.head&&e.jsx(ie,{children:e.jsx(R,{children:a.head.map((t,o)=>e.jsx(q,{children:t},o))})}),a.body&&e.jsx(ce,{children:a.body.map((t,o)=>e.jsx(R,{children:t.map((r,l)=>e.jsx(de,{children:r},l))},o))}),a.foot&&e.jsx(me,{children:e.jsx(R,{children:a.foot.map((t,o)=>e.jsx(q,{children:t},o))})})]})}V.displayName="@mantine/core/TableDataRenderer";const Ze={type:"scrollarea"},Je=se((a,{minWidth:t,maxHeight:o,type:r})=>({scrollContainer:{"--table-min-width":$(t),"--table-max-height":$(o),"--table-overflow":r==="native"?"auto":void 0}})),Y=z((a,t)=>{const o=O("TableScrollContainer",Ze,a),{classNames:r,className:l,style:d,styles:n,unstyled:i,vars:b,children:f,minWidth:p,maxHeight:y,type:c,scrollAreaProps:s,attributes:u,...T}=o,_=te({name:"TableScrollContainer",classes:P,props:o,className:l,style:d,classNames:r,styles:n,unstyled:i,attributes:u,vars:b,varsResolver:Je,rootSelector:"scrollContainer"});return e.jsx(W,{component:c==="scrollarea"?Ve:"div",...c==="scrollarea"?y?{offsetScrollbars:"xy",...s}:{offsetScrollbars:"x",...s}:{},ref:t,..._("scrollContainer"),...T,children:e.jsx("div",{..._("scrollContainerInner"),children:f})})});Y.classes=P;Y.displayName="@mantine/core/TableScrollContainer";const ea={withRowBorders:!0,verticalSpacing:7},aa=se((a,{layout:t,captionSide:o,horizontalSpacing:r,verticalSpacing:l,borderColor:d,stripedColor:n,highlightOnHoverColor:i,striped:b,highlightOnHover:f,stickyHeaderOffset:p,stickyHeader:y})=>({table:{"--table-layout":t,"--table-caption-side":o,"--table-horizontal-spacing":Q(r),"--table-vertical-spacing":Q(l),"--table-border-color":d?F(d,a):void 0,"--table-striped-color":b&&n?F(n,a):void 0,"--table-highlight-on-hover-color":f&&i?F(i,a):void 0,"--table-sticky-header-offset":y?$(p):void 0}})),x=z((a,t)=>{const o=O("Table",ea,a),{classNames:r,className:l,style:d,styles:n,unstyled:i,vars:b,horizontalSpacing:f,verticalSpacing:p,captionSide:y,stripedColor:c,highlightOnHoverColor:s,striped:u,highlightOnHover:T,withColumnBorders:_,withRowBorders:N,withTableBorder:m,borderColor:D,layout:va,variant:ue,data:X,children:he,stickyHeader:pe,stickyHeaderOffset:Na,mod:ge,tabularNums:fe,attributes:ye,...xe}=o,K=te({name:"Table",props:o,className:l,style:d,classes:P,classNames:r,styles:n,unstyled:i,attributes:ye,rootSelector:"table",vars:b,varsResolver:aa});return e.jsx(Xe,{value:{getStyles:K,stickyHeader:pe,striped:u===!0?"odd":u||void 0,highlightOnHover:T,withColumnBorders:_,withRowBorders:N,captionSide:y||"bottom"},children:e.jsx(W,{component:"table",variant:ue,ref:t,mod:[{"data-with-table-border":m,"data-tabular-nums":fe},ge],...K("table"),...xe,children:he||!!X&&e.jsx(V,{data:X})})})});x.classes=P;x.displayName="@mantine/core/Table";x.Td=de;x.Th=q;x.Tr=R;x.Thead=ie;x.Tbody=ce;x.Tfoot=me;x.Caption=be;x.ScrollContainer=Y;x.DataRenderer=V;const oa="_spacer_9cq6l_1",ta="_tr_9cq6l_13",sa="_tr__myrow_9cq6l_21",ra="_td__rank_9cq6l_28",na="_td__player_9cq6l_35",la="_td__score_9cq6l_39",da="_table_9cq6l_51",ia="_tbody_9cq6l_57",ca="_userNameBox_9cq6l_63",ma="_userNameBox2_9cq6l_71",ba="_userName_9cq6l_63",ua="_userNameHidden_9cq6l_90",g={spacer:oa,tr:ta,tr__myrow:sa,td__rank:ra,td__player:na,td__score:la,table:da,tbody:ia,userNameBox:ca,userNameBox2:ma,userName:ba,userNameHidden:ua},ha=({player:a})=>{const t=S(l=>{var d;return(d=l.platform.player)==null?void 0:d.id}),o=U.isPremium()&&a.id===t;re();const r=je(a.name);return e.jsxs(L,{wrap:"nowrap",align:"center",mih:36,mah:36,h:36,style:{position:"relative"},children:[o&&e.jsx(L,{style:{position:"absolute",zIndex:2,left:-8},children:e.jsx(Ce,{size:52})}),e.jsx(ve,{src:a.avatar,radius:o?0:"50%",size:36,mr:12,style:o?{transform:"translateY(3px) scale(0.8)"}:{}}),e.jsx("div",{className:g.userNameBox,children:e.jsxs("div",{className:g.userNameBox2,children:[r&&e.jsx("div",{className:g.userName,children:r}),!r&&e.jsx("div",{className:E(g.userName,g.userNameHidden),children:A("userHidden")})]})})]})},pa=v.memo(ha),ga=({leaderboardEntries:a,loading:t,valueIcon:o,visible:r,scoreFormatter:l})=>{const d=re(),n=H(),i=S(s=>s.platform.player),b=B(s=>s.modals.openUserProfileModal),f=S(s=>s.config.leaderboardMode),p=S(s=>s.config.leaderboardSelectedTab),y=async s=>{if(s.id!==i.id){const u=await U.getOtherPlayers([s.id]);if(u&&u[0]){const T=u[0].state,_=[h.OnlineScore,h.Rating].includes(p),N=[h.WithComputerScore,h.WithComputerRating].includes(p),m=[h.SingleScore,h.SingleTimeLvl1,h.SingleTimeLvl2,h.SingleTimeLvl3].includes(p);b({player:{state:{...T,name:T.name||"guest",playerData:T.playerData||_e()}},tabType:_?G.Online:N?G.Computer:m?G.Single:void 0})}}else b({player:{state:i}})},c=M.useMemo(()=>(a||[]).reduce((s,u)=>u.position-s===1?u.position:s,0),[a]);return t?e.jsx(L,{direction:"column",align:"center",justify:"center",mt:32,children:e.jsx(Te,{size:32})}):a===null?e.jsx(L,{direction:"column",m:4,mt:"md",children:A("connectionError")}):e.jsx(L,{direction:"column",mt:"md",m:n?0:4,children:e.jsx(x,{className:g.table,children:e.jsx("tbody",{className:g.tbody,children:a.map((s,u)=>(![3,4].includes(u)||s.position<=7)&&e.jsxs(v.Fragment,{children:[f===k.Leaders&&s.id===i.id&&s.position>22&&e.jsxs("tr",{className:g.spacer,children:[e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{onClick:()=>y(s),id:String(s.id),className:E(g.tr,{[g.tr__myrow]:`${s.id}`==`${i.id}`}),children:[e.jsx("td",{className:g.td__rank,children:s.position}),e.jsx("td",{className:g.td__player,children:e.jsx(pa,{player:s})}),e.jsxs("td",{className:g.td__score,children:[l?l(Number(s.score),d):Number.isNaN(s.score)?"-":ne(Number(s.score)),o]})]}),s.position===c&&f===k.Default&&a.length>3&&e.jsxs("tr",{className:g.spacer,children:[e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{})]})]},s.id))})})})},fa=v.memo(ga),ya=a=>{const{isLoading:t,selectedTab:o}=a,r=o||h.TotalScore,l=S(d=>d.platform.leaderboardEntriesByType[d.config.leaderboardMode][r],le);return e.jsx(fa,{loading:t,visible:!0,leaderboardEntries:l,scoreFormatter:Z(r)?Ye:d=>d>0?ne(Math.round(d)):0,valueIcon:[h.Rating,h.WithComputerRating].includes(r)?e.jsx(Ne,{size:14,ml:5}):Z(r)?e.jsx(Me,{size:14,ml:5}):r===h.Cash?e.jsx(Le,{size:14,ml:5}):e.jsx(Be,{size:14,ml:5})})},xa=v.memo(ya),Sa="_rootSegmentControl_1oyva_1",Ta={rootSegmentControl:Sa},I=a=>{const{data:t,value:o,onChange:r,firstFullWidth:l}=a,n=H()?5:0,i=`calc(100% - ${n*2}px)`,b=we(Pe.Neutral);return e.jsx(Re,{style:{flexWrap:"wrap",width:i,marginBottom:5,marginLeft:n,marginRight:n},styles:{indicator:{backgroundColor:b}},classNames:{root:E({[Ta.rootSegmentControl]:l})},id:w.modal.leaderboard.leaderBoardTypeSegmentControl.index,data:t,value:o,onChange:r})};let ae=C.TotalScore;const _a=a=>{const{children:t,singleSegmentData:o}=a,r=B(c=>c.config.setLeaderboardGameModeTab),l=B(c=>c.config.setLeaderboardSelectedTab),d=S(c=>c.config.leaderboardSelectedTab),n=S(c=>c.config.leaderboardGameModeTab),i=ke(),b=H(),f=He(w.modal.leaderboard.leaderBoardTypeSegmentControl.gameModeTab),p=De(w.modal.leaderboard.leaderBoardTypeSegmentControl.tab),y=!!Fe().feature[Ge.SingleGame];return M.useEffect(()=>{ae!==n&&(n===C.WithOpponentGame?l(h.WithComputerScore):n===C.SingleGame?l(h.SingleScore):n===C.TotalScore&&l(h.TotalScore),ae=n)},[n]),e.jsxs(e.Fragment,{children:[y&&o?e.jsxs(e.Fragment,{children:[e.jsx(I,{data:f,value:(n??"").toString(),onChange:r,firstFullWidth:i&&b}),n!==C.TotalScore&&e.jsx(I,{data:n===C.WithOpponentGame?p:o,value:d,onChange:l})]}):e.jsx(I,{data:p,value:d,onChange:l}),t&&t(n?d:void 0)]})},ja=v.memo(_a);let oe=null;const Ca=a=>{const{singleSegmentData:t}=a,{closeModal:o}=Ie($e.LeaderboardModal),r=S(m=>m.platform.leaderboardEntriesByType,le),l=B(m=>m.platform.updateLeaderboardByType),d=B(m=>m.config.switchLeaderboardMode),n=S(m=>m.config.leaderboardSelectedTab),i=S(m=>m.config.leaderboardMode),b=J(ee.Primary),f=J(ee.Light),[p,y]=M.useState(!1),[c,s]=M.useState(!1),u=H(),T=qe(ze.NonGameButton,{place:"LeaderboardModalClose"}),_=()=>{o(),T()},N=()=>{d(Ee.toggle)};return M.useEffect(()=>{var m;if(!((m=r[i][n])!=null&&m.length)){const D=oe===i?y:s;D(!0),l(n).then(()=>D(!1))}oe=i},[n,i]),e.jsx(Ue,{visible:!0,id:w.modal.leaderboard.index,onClose:_,size:"850px",yOffset:"calc( var(--vh, 1vh) * 3 )",innerHeight:"100%",bodyPadding:u?"0":void 0,closeOffset:2,title:e.jsxs(e.Fragment,{children:[A("leaders"),!U.isTV()&&e.jsx(Oe,{id:w.modal.leaderboard.actionIcon.changeMode,loading:c,disabled:c,onClick:N,...i===k.Leaders&&b,...i===k.Default&&f,size:32,children:e.jsx(We,{children:e.jsx(Ae,{size:22})})})]}),titleCentered:!0,children:e.jsx(ja,{singleSegmentData:t,children:m=>e.jsx(xa,{isLoading:p||c,selectedTab:m})})})},ka=v.memo(Ca);export{ka as default};
